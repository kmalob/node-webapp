pipeline {
    agent any
    environment {
        dockerImageName = 'node-app'
        dockerImageTag = 'latest'
        dockerImage = "${dockerImageName}:${dockerImageTag}"
    }
    stages {
        stage('Clone Repository') {
            steps {
                git branch: 'main', credentialsId: '6a64497d-d665-4954-9ce4-e8221175197f', url: 'http://github.com/kmalob/node-webapp'
            }
        }
        stage('Build Docker Image') {
            steps {
                script {
                    docker.build "${dockerImageName}:${env.BUILD_ID}"
                }
            }
        }
        stage('Run Container') {
            steps {
                script {
                    docker.image("${dockerImageName}:${env.BUILD_ID}").inside {
                    }
                }
            }
        }
    }
}   
